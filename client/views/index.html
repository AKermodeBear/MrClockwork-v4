<html lang="en">

  <head>
    <meta charset="utf-8" />

    <title>Mr. Clockwork Dominions Hosting Website</title>
    <meta name="author" content="Hugo Bujan Prevot" />
    <meta
      name="description"
      content="Preferences page of the Dominions hosting Discord bot"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="keywords"
      content="home, clockwork, dominions, strategy, turn-based, mythology, pretender, pantheon, pantokrator, hosting, online, multiplayer"
    />
    <meta http-equiv="refresh" content="60" />
      
    <!-- jQuery, Popper and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <!-- Latest compiled and minified JavaScript for bootstrap-select  -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
      
    <!-- Handlebars -->
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
      
    <!-- Bootstrap 4 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="css/main.css" />
      
    <!-- Latest compiled and minified CSS for bootstrap-select, docs: https://developer.snapappointments.com/bootstrap-select/examples/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
  </head>

  <body>
      
    <!-- MAIN CONTAINER FOR BOTH THE HEADER OF THE PAGE AND THE BODY -->
    <div class="container main_container">
        
        <!-- HEADER -->
        <div class="row page_header">
            
            <!-- Filler column -->
            <div class="col-md"></div>
            
            <!-- BANNER COLUMN -->
            <div class="col">
                <img src="img/logo.png" class="img-fluid w-50" alt="Mr. Clockwork logo">
            </div>
            
            <!-- NAVBAR COLUMN -->
            <div class="col-4 text-h-centered text-v-centered">
                
                <!-- Navbar expands on medium screens or larger -->
                <!-- Original navbar code taken from: https://mdbootstrap.com/docs/jquery/navigation/navbar/ and edited to fit my purpose -->
                <nav class="navbar navbar-expand-md navbar-dark">
                    
                    <!-- On smaller screens it collapses and a toggler button shows up -->
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContainer"
                        aria-controls="navbarContainer" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    
                    <div class="collapse navbar-collapse" id="navbarContainer">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item active">
                                <a class="nav-link" href="index.html">Home</a>
                            </li>
                            <li class="nav-item active">
                                <a class="nav-link" href="list_games.html">Check a game</a>
                            </li>
                        </ul>
                    </div>
                    
                </nav>
                
            </div>
            
            <!-- Filler column -->
            <div class="col-md"></div>
            
        </div>
        <!---------------->
        
        <!-- BODY -->
        <div class="row section">
            
            <!-- Left buffer column that pads the space between the content sections and the body -->
            <div class="col-md buffer_left"></div>
            <div class="col-md-8 main_section">
            
                <div class="section">
                    
                    <!-- Discord Oauth2 flow: https://discordjs.guide/oauth2/#putting-it-together -->
                    <a id="login" style="display: none;" href="https://discord.com/api/oauth2/authorize?client_id=721522017249263737&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Flogin&response_type=code&scope=identify">Identify Yourself</a>
                    <script>

                        window.onload = () => 
                        {
                            const fragment = new URLSearchParams(window.location.hash.slice(1));

                            if (fragment.has("access_token")) 
                            {
                                const accessToken = fragment.get("access_token");
                                const tokenType = fragment.get("token_type");

                                fetch('https://discord.com/api/users/@me', {
                                    headers: {
                                        authorization: `${tokenType} ${accessToken}`
                                    }
                                })
                                .then((res) => res.json())
                                .then((response) => 
                                {
                                    console.log(response);
                                    const { username, discriminator } = response;
                                    document.getElementById('info').innerText += ` ${username}#${discriminator}`;
                                })
                                .catch(console.error);
                            }

                            else document.getElementById('login').style.display = 'block';
                        }

                    </script>
                    
                </div>
            
            
            </div>
            
            <!-- Right buffer column that pads the space between the content sections and the body -->
            <div class="col-md buffer_right"></div>
        
        </div>
        <!---------------->
        
        
        <!-- FOOTER SECTION -->
        <footer class="row">
            
            <div class="col container">
            
                <p class="text-h-centered text-v-centered">
                    Â© Hugo Bujan Prevot 2020<br>
                    hugo.bujan@gmail.com<br>
                </p>
            
            </div> 
        
        </footer>
        <!---------------->
        
    </div>

    
  </body>
</html>
